if shell.dir()=="" then
os.shutdown()
end

local tArgs = { ... }
if #tArgs < 1 then
	print( "Usage: cd <path>" )
	return
end
if not os.user then
shell.run("/rom/programs/cd "..tArgs[1])
return end

if tArgs[1]=="disk" then
tArgs[1]="/disk"
end

local sNewDir = shell.resolve( tArgs[1] )
if fs.isDir( sNewDir ) then
if sNewDir=="secacct" then
print("Not allowed.")
elseif shell.dir()=="/disk" and sNewDir == "" then
shell.setDir("/secacct/"..os.user)
elseif sNewDir=="" then print("Not allowed.")
else
	shell.setDir( sNewDir )
end
else
  	print( "Not a directory" )
  	return
end
