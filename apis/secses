function isPrime(num)
  if type(num)~="number" or num<2 then
    return false
  elseif num<4 then
    return true
  end
  for i=2, math.sqrt(num) do
    if num%i==0 then return false end
  end
  return true
end
function gcd(m,n)
  while m~=0 do
    m,n=n%m, m
  end
  return n
end
local results
function isPrimitiveRoot(m,n)
  --Is m a primitive root of n
  results={}
  local r=0
  for i=0,math.huge do
    if results[(m^i)%n] then
      r=(m^i)%n.." "..i
      break
    else
      results[(m^i)%n]=true
    end
  end
  for g=2, n-1 do
    if not results[g] then
      return false, g, r
    end
  end
  return true
end
function getDHPrimes()
  local p,g=0,0
  while not isPrime(p) do
    p=math.random(1,2^31-1)
  end
  local i=1
  repeat
    i=i+1
    term.clearLine()
    term.setCursorPos(1,select(2,term.getCursorPos()))
    write(p.." "..i.." ")
    write(select(2, isPrimitiveRoot(i,p)).." ")
    write(select(3, isPrimitiveRoot(i,p)))
    if i%7500==0 then sleep(0) end
  until isPrimitiveRoot(i, p)
  return p,g
end
